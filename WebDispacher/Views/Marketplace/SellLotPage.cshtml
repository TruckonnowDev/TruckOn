@using Microsoft.AspNetCore.Mvc.Localization
@using WebDispacher.Constants;
@using WebDispacher.Service;
@using WebDispacher.ViewModels.Marketplace;

@inject IViewLocalizer Localizer

@model SellItemMarketPostViewModel
@{
    ViewData["Title"] = "Sell Lot | Marketplace";
}

<link rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />

<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

<link rel="stylesheet" href="~/css/Marketplace/Marketplace.css">

<link rel="stylesheet" href="~/libs/jquery/lightgallery.css">
<body>
    <div class="admin">
        <div class="container">
            <div class="row">
                <div class="col-md-12"
                     style="
                       margin-top: 50px;">
                    <div class="nav-forum-marketplace">
                        <div class="nav-forum-item">
                            <a href="/Marketplace/">
                                @Localizer["MarketplaceForumNav"]
                            </a>
                            <i class="bi bi-arrow-right"></i>
                        </div>
                        <div class="nav-forum-item">
                            <a href="/Marketplace/Classifieds">
                                @Localizer["ClassifiedsForumNav"]
                            </a>
                            <i class="bi bi-arrow-right"></i>
                        </div>
                        <div class="nav-forum-item">
                            <a href="/Marketplace/Classifieds/CategorySell">
                                @Localizer["CategorySellForumNav"]
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-md-12" style="margin-bottom: 10%;">
                    <div class="tabContent">
                        <div class="row">
                            <div class="col-md-7">
                                <div class="img-block" style="width:100%;padding: 16px;padding-left:0px;" id="lightgallery">
                                    <div style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff" class="swiper mySwiper2">
                                        <div class="swiper-wrapper">
                                            @if (Model?.PhotoListMP?.Photos == null || Model?.PhotoListMP?.Photos.Count == 0)
                                            {
                                                <div class="swiper-slide">
                                                    <span class="no-photos-item">@Localizer["NoImagesBlockHeader"]</span>
                                                </div>
                                            }
                                            else
                                            {
                                                @foreach (var item in Model?.PhotoListMP?.Photos)
                                                {
                                                    <div class="swiper-slide">
                                                        <a href="@Config.BaseReqvesteUrl/Marketpace/Image?imagePath=@item.PhotoPath" target="_blank" style="cursor: zoom-in">
                                                            <img src="@Config.BaseReqvesteUrl/Marketpace/Image?imagePath=@item.PhotoPath" />
                                                        </a>
                                                    </div>
                                                }
                                            }
                                        </div>
                                        <div class="swiper-button-next"></div>
                                        <div class="swiper-button-prev"></div>
                                        @if (Model.MarketPost.ConditionPost == DaoModels.DAO.Enum.ConditionPost.Deleted)
                                        {
                                            <div class="block-status">
                                                <span>@Localizer["RemovedPostStatus"]</span>
                                            </div>
                                        }
                                        @if (Model.MarketPost.ConditionPost == DaoModels.DAO.Enum.ConditionPost.Sold)
                                        {
                                            <div class="block-status">
                                                <span>@Localizer["SoldPostStatus"]</span>
                                            </div>
                                        }
                                    </div>
                                    <div thumbsSlider="" class="swiper mySwiper">
                                        <div class="swiper-wrapper">
                                            @if (Model?.PhotoListMP?.Photos != null && Model?.PhotoListMP?.Photos.Count != 0)
                                            {
                                                @foreach (var item in Model.PhotoListMP.Photos)
                                                {
                                                    <div class="swiper-slide">
                                                        <img src="@Config.BaseReqvesteUrl/Marketpace/Image?imagePath=@item.PhotoPath" alt=""/>
                                                    </div>
                                                }
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5" style="padding: 6px;">
                                <div class="main-short-text-block">
                                    <div class="main-text-block">
                                        <h2>@Model.Title</h2>
                                        <h3>
                                            @switch (Model.ConditionItem)
                                            {
                                                case DaoModels.DAO.Enum.ConditionItem.New:
                                                    {
                                                        <span class="badge bg-success">@Localizer["NewItemCondition"]</span>
                                                        break;
                                                    }
                                                case DaoModels.DAO.Enum.ConditionItem.LikeNew:
                                                    {
                                                        <span class="badge bg-secondary ">@Localizer["LikeNewItemCondition"]</span>
                                                        break;
                                                    }

                                                case DaoModels.DAO.Enum.ConditionItem.Good:
                                                    {
                                                        <span class="badge bg-secondary ">@Localizer["GoodItemCondition"]</span>
                                                        break;
                                                    }
                                                case DaoModels.DAO.Enum.ConditionItem.Fair:
                                                    {
                                                        <span class="badge bg-warning">@Localizer["FairItemCondition"]</span>
                                                        break;
                                                    }
                                            }

                                                @switch (Model.MarketPost.ConditionPost)
                                                {
                                                    case DaoModels.DAO.Enum.ConditionPost.Published:
                                                        {
                                                            <span class="badge bg-success">@Localizer["PublicStatusPostItem"]</span>
                                                            break;
                                                        }
                                                    case DaoModels.DAO.Enum.ConditionPost.Hidden:
                                                        {
                                                            <span class="badge bg-secondary ">@Localizer["HideStatusPostItem"]</span>
                                                            break;
                                                        }

                                                    case DaoModels.DAO.Enum.ConditionPost.Sold:
                                                        {
                                                            <span class="badge bg-warning ">@Localizer["SoldStatusPostItem"]</span>
                                                            break;
                                                        }
                                                    case DaoModels.DAO.Enum.ConditionPost.Deleted:
                                                        {
                                                            <span class="badge bg-danger">@Localizer["DeleteStatusPostItem"]</span>
                                                            break;
                                                        }
                                                }
                                        </h3>
                                        <h1> <i class="bi bi-currency-dollar" style="font-size:36px;margin-left:-8px;"></i> @Model.Price</h1>
                                        <div class="zip-code">
                                            <h3>@Localizer["ZipCodeLabel"] -- <b>@Model.ZipCode</b></h3>
                                        </div>
                                    </div>
                                    <div class="control-panel mt-4">
                                        @if (Model.MarketPost.ConditionPost != DaoModels.DAO.Enum.ConditionPost.Deleted
                                            && Model.MarketPost.ConditionPost != DaoModels.DAO.Enum.ConditionPost.Sold)
                                        {
                                            @if (ViewBag.QueryUser.Id.Equals(Model.MarketPost.UserId))
                                            {
                                                <a class="btn2 mt-3" href="/Marketplace/Classifieds/CategorySell/@Model.MarketPostId/Edit">@Localizer["ManageButton"]</a>
                                            }
                                            else
                                            {
                                                <button type="button" class="btn3">@Localizer["WriteButton"]</button>
                                                <button type="button" class="btn2 mt-3" data-toggle="modal" href="#showPhoneNumber">@Localizer["CallButton"]</button>
                                            }

                                        }
                                    </div>
                                    <div class="info-seller">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="text-block">
                                    <div class="description">
                                        <h2>@Localizer["DescriptionBlockLabel"]</h2>
                                        <p>@Model.Description</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @await Html.PartialAsync("~/Views/PartView/Modals/ShowPhoneNumber.cshtml", $"+{Model?.PhoneNumber?.DialCode} {Model?.PhoneNumber?.Number}")
</body>

<script>
    var swiper = new Swiper(".mySwiper", {
        spaceBetween: 8,
        slidesPerView: 6,
        freeMode: true,
        watchSlidesProgress: true,
    });
    var swiper2 = new Swiper(".mySwiper2", {
        spaceBetween: 8,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        thumbs: {
            swiper: swiper,
        },
    });
</script>

<style>
    .swiper {
        width: 100%;
        height: 100%;
    }

    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #fff;
        display: flex;
        justify-content: center;
        align-items: center;
        height: auto;
        max-height: 450px;
    }

        .swiper-slide img {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .swiper {
        width: 100%;
        height: 300px;
        margin-left: auto;
        margin-right: auto;
    }

    .swiper-slide {
        background-size: cover;
        background-position: center;
    }

    .mySwiper2 {
        height: 80%;
        width: 100%;
        border-radius: 8px;
    }

    .mySwiper {
        height: 20%;
        box-sizing: border-box;
        padding: 10px 2px;
    }

        .mySwiper .swiper-slide {
            width: 25%;
            height: 86px;
            opacity: 0.4;
            cursor: pointer;
        }

    .mySwiper2 .swiper-slide-active {
        transition: transform 0.3s ease;
    }

        .mySwiper2 .swiper-slide-active:hover {
            transform: scale(1.05);
        }

    .mySwiper .swiper-slide-thumb-active {
        opacity: 1;
    }

        .mySwiper .swiper-slide-thumb-active img {
            border: 2px red solid;
        }

    .swiper-slide img {
        display: block;
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
</style>
<style>
    .btn2, .btn3 {
        max-width: 300px;
    }

    .btn2 {
        text-align: center;
    }

    .intl-tel-input {
        width: 100%;
    }


    .nav-forum-marketplace {
        display: flex;
    }

    .nav-forum-item {
        margin-right: 10px;
    }

        .nav-forum-item a {
            margin-right: 10px;
        }

    .other-img {
        justify-content: center;
        padding: 18px;
        display: grid;
        grid-template-columns: repeat(5, 120px);
        gap: 8px;
    }

        .other-img .img-one {
            max-width: 100%;
            height: auto;
            border: 1px black solid;
        }

    .control-panel {
        display: flex;
        flex-direction: column;
    }


    .badge {
        font-weight: 600;
        font-size: 16px;
    }
</style>

<script src="~/js/input-replacer.js"></script>
<script>
    $(document).ready(function () {
        ShowAlert();
     });

    function changeImage(imageUrl) {
        const mainImage = document.getElementById('mainImage');
        mainImage.src = imageUrl;
        mainImage.alt = "Главная картинка";
    }
</script>